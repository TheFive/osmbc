include mixins

block all
  doctype html
  html(lang='en')
    head
      meta(charset='utf-8')
      meta(http-equiv='X-UA-Compatible', content='IE=edge')
      meta(name='viewport', content='width=device-width, initial-scale=1')
      meta(name='description', content='')
      meta(name='author', content='')
      link(rel='icon', href='/favicon.ico')
      title=layout.title
      // Bootstrap core CSS
      link(href=layout.path("bootstrap")+'/css/bootstrap.min.css', rel='stylesheet')
      link(href=layout.path("font-awesome")+"/css/font-awesome.min.css" rel='stylesheet')

    body

        // Fixed navbar
        .navbar.navbar-default.navbar-fixed-top(role='navigation')
          .container-fluid
            .navbar-header.pull-left
              if layout.osmbc_version === layout.user.lastChangeLogView
                a.navbar-brand(href=layout.htmlroot+'/osmbc.html')=layout.appName
              else
                a.navbar-brand.bg-success(href=layout.htmlroot+'/changelog') What's New?
            .navbar-header
              button.navbar-toggle.pull-right(type='button', data-toggle='collapse', data-target='.navbar-collapse')
                span.sr-only Toggle navigation
                span.icon-bar
                span.icon-bar
                span.icon-bar
            .navbar-collapse.collapse
              if (layout.user.access === "full")
                ul.nav.navbar-nav.navbar-left
                  li.dropdown
                    a.dropdown-toggle(href='#', data-toggle='dropdown')
                      | User
                      span.caret
                    ul.dropdown-menu(role='menu')
                      li
                        a#createUser(href=layout.htmlroot + "/usert/create") Create
                      li.dropdown-header Lists
                      li
                        a(href=layout.htmlroot + "/usert/list?access=full") List Active
                      li
                        a(href=layout.htmlroot + "/usert/list?access=guest") List Guest
                      li
                        a(href=layout.htmlroot + "/usert/list?temporaryGuest=true") List Full User Testing Guest
                      li
                        a(href=layout.htmlroot + "/usert/list?access=denied") List Denied
                      li
                        a(href=layout.htmlroot + "/usert/list") List All
                      li
                        a(href=layout.htmlroot + "/usert/list?access=full&sort=lastAccess&desc=true&lastAccess=!=never") Who Is Online
                  li.dropdown.hidden-xs
                    a.dropdown-toggle(href='#', data-toggle='dropdown')
                      | Tool
                      span.caret
                    ul.dropdown-menu(role='menu')
                      li.dropdown-header Action
                      li
                        a#createblog(href=layout.htmlroot+"/createblog") Create Blog
                  li
                    a(href=layout.htmlroot+"/osmbc/admin") Admin

              ul.nav.navbar-nav.navbar-right
                +helpMenu   

                li.dropdown
                  a.btn.dropdown-toggle.osmbcbadge-lang(href='#', style="color:white", data-toggle='dropdown')=layout.language
                    span.caret
                  ul.dropdown-menu(role='menu')
                    each l in layout.languages
                      li
                        a(id=langString+"_"+l onclick = "chooseLanguage('lang','" + l +"')")=l
                if layout.user
                  li
                    img(src=layout.user.getAvatar() onclick="location.href='" + layout.htmlroot + "/usert/" + layout.user.id + "';" style="width:50px;height:50px")
                else
                  li
                    a(href='./') Anonymous
            // /.nav-collapse


        .container-fluid

            p
             block content
            p

        // /container

        // Bootstrap core JavaScript
        // ==================================================
        // Placed at the end of the document so the pages load faster

        script(src=layout.path("jquery")+'/jquery.min.js')
        script(src=layout.path("bootstrap")+'/js/bootstrap.min.js')

  doctype html
  html
    head
      title= title
      link(rel='stylesheet', href=`${layout.htmlroot}${layout.style}`)
    body
  script(nonce=cspNonce).

    // Init This Window with jQuery ready Callback
    function chooseLanguage(number,lang) {
      var data = {};
      data[number]=lang;
      jQuery.post("!{htmlroot}/language",data, function () {
        location.reload();
      }).fail(function (err) {
        console.error("Problem changing language " +  number + " " + lang);
        console.error(err);
      });
    }

  block scripts
